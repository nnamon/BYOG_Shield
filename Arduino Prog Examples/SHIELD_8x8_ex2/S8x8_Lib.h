//===============================================================================================================================
// LED 8x8
//===============================================================================================================================
int pb1Pin = 5;
int pb2Pin = 6;
int ledPin = 10;

int latchPin = 7;
int clockPin = 8;
int dataPin = 9;

const char data[][8] ={
{0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000},
{0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000000, 0B00000100},
{0B00001010, 0B00001010, 0B00001010, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000},
{0B00000000, 0B00001010, 0B00011111, 0B00001010, 0B00011111, 0B00001010, 0B00011111, 0B00001010},
{0B00000111, 0B00001100, 0B00010100, 0B00001100, 0B00000110, 0B00000101, 0B00000110, 0B00011100},
{0B00011001, 0B00011010, 0B00000010, 0B00000100, 0B00000100, 0B00001000, 0B00001011, 0B00010011},
{0B00000110, 0B00001010, 0B00010010, 0B00010100, 0B00001001, 0B00010110, 0B00010110, 0B00001001},
{0B00000100, 0B00000100, 0B00000100, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000},
{0B00000010, 0B00000100, 0B00001000, 0B00001000, 0B00001000, 0B00001000, 0B00000100, 0B00000010},
{0B00001000, 0B00000100, 0B00000010, 0B00000010, 0B00000010, 0B00000010, 0B00000100, 0B00001000},
{0B00010101, 0B00001110, 0B00011111, 0B00001110, 0B00010101, 0B00000000, 0B00000000, 0B00000000},
{0B00000000, 0B00000000, 0B00000100, 0B00000100, 0B00011111, 0B00000100, 0B00000100, 0B00000000},
{0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000110, 0B00000100, 0B00001000},
{0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00001110, 0B00000000, 0B00000000, 0B00000000},
{0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000100},
{0B00000001, 0B00000010, 0B00000010, 0B00000100, 0B00000100, 0B00001000, 0B00001000, 0B00010000},
{0B00001110, 0B00010001, 0B00010011, 0B00010001, 0B00010101, 0B00010001, 0B00011001, 0B00001110},
{0B00000100, 0B00001100, 0B00010100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00011111},
{0B00001110, 0B00010001, 0B00010001, 0B00000010, 0B00000100, 0B00001000, 0B00010000, 0B00011111},
{0B00001110, 0B00010001, 0B00000001, 0B00001110, 0B00000001, 0B00000001, 0B00010001, 0B00001110},
{0B00010000, 0B00010000, 0B00010100, 0B00010100, 0B00011111, 0B00000100, 0B00000100, 0B00000100},
{0B00011111, 0B00010000, 0B00010000, 0B00011110, 0B00000001, 0B00000001, 0B00000001, 0B00011110},
{0B00000111, 0B00001000, 0B00010000, 0B00011110, 0B00010001, 0B00010001, 0B00010001, 0B00001110},
{0B00011111, 0B00000001, 0B00000001, 0B00000001, 0B00000010, 0B00000100, 0B00001000, 0B00010000},
{0B00001110, 0B00010001, 0B00010001, 0B00001110, 0B00010001, 0B00010001, 0B00010001, 0B00001110},
{0B00001110, 0B00010001, 0B00010001, 0B00001111, 0B00000001, 0B00000001, 0B00000001, 0B00000001},
{0B00000000, 0B00000100, 0B00000100, 0B00000000, 0B00000000, 0B00000100, 0B00000100, 0B00000000},
{0B00000000, 0B00000100, 0B00000100, 0B00000000, 0B00000000, 0B00000100, 0B00000100, 0B00001000},
{0B00000001, 0B00000010, 0B00000100, 0B00001000, 0B00001000, 0B00000100, 0B00000010, 0B00000001},
{0B00000000, 0B00000000, 0B00000000, 0B00011110, 0B00000000, 0B00011110, 0B00000000, 0B00000000},
{0B00010000, 0B00001000, 0B00000100, 0B00000010, 0B00000010, 0B00000100, 0B00001000, 0B00010000},
{0B00001110, 0B00010001, 0B00010001, 0B00000010, 0B00000100, 0B00000100, 0B00000000, 0B00000100},
{0B00001110, 0B00010001, 0B00010001, 0B00010101, 0B00010101, 0B00010001, 0B00010001, 0B00011110},
{0B00001110, 0B00010001, 0B00010001, 0B00010001, 0B00011111, 0B00010001, 0B00010001, 0B00010001},
{0B00011110, 0B00010001, 0B00010001, 0B00011110, 0B00010001, 0B00010001, 0B00010001, 0B00011110},
{0B00000111, 0B00001000, 0B00010000, 0B00010000, 0B00010000, 0B00010000, 0B00001000, 0B00000111},
{0B00011100, 0B00010010, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010010, 0B00011100},
{0B00011111, 0B00010000, 0B00010000, 0B00011110, 0B00010000, 0B00010000, 0B00010000, 0B00011111},
{0B00011111, 0B00010000, 0B00010000, 0B00011110, 0B00010000, 0B00010000, 0B00010000, 0B00010000},
{0B00001110, 0B00010001, 0B00010000, 0B00010000, 0B00010111, 0B00010001, 0B00010001, 0B00001110},
{0B00010001, 0B00010001, 0B00010001, 0B00011111, 0B00010001, 0B00010001, 0B00010001, 0B00010001},
{0B00011111, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00011111},
{0B00011111, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00010100, 0B00001000},
{0B00010001, 0B00010010, 0B00010100, 0B00011000, 0B00010100, 0B00010010, 0B00010001, 0B00010001},
{0B00010000, 0B00010000, 0B00010000, 0B00010000, 0B00010000, 0B00010000, 0B00010000, 0B00011111},
{0B00010001, 0B00011011, 0B00011111, 0B00010101, 0B00010001, 0B00010001, 0B00010001, 0B00010001},
{0B00010001, 0B00011001, 0B00011001, 0B00010101, 0B00010101, 0B00010011, 0B00010011, 0B00010001},
{0B00001110, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00001110},
{0B00011110, 0B00010001, 0B00010001, 0B00011110, 0B00010000, 0B00010000, 0B00010000, 0B00010000},
{0B00001110, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010101, 0B00010011, 0B00001111},
{0B00011110, 0B00010001, 0B00010001, 0B00011110, 0B00010100, 0B00010010, 0B00010001, 0B00010001},
{0B00001110, 0B00010001, 0B00010000, 0B00001000, 0B00000110, 0B00000001, 0B00010001, 0B00001110},
{0B00011111, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100},
{0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00001110},
{0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00001010, 0B00000100},
{0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010001, 0B00010101, 0B00010101, 0B00001010},
{0B00010001, 0B00010001, 0B00001010, 0B00000100, 0B00000100, 0B00001010, 0B00010001, 0B00010001},
{0B00010001, 0B00010001, 0B00001010, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100},
{0B00011111, 0B00000001, 0B00000010, 0B00000100, 0B00001000, 0B00010000, 0B00010000, 0B00011111},
{0B00001110, 0B00001000, 0B00001000, 0B00001000, 0B00001000, 0B00001000, 0B00001000, 0B00001110},
{0B00010000, 0B00001000, 0B00001000, 0B00000100, 0B00000100, 0B00000010, 0B00000010, 0B00000001},
{0B00001110, 0B00000010, 0B00000010, 0B00000010, 0B00000010, 0B00000010, 0B00000010, 0B00001110},
{0B00000100, 0B00001010, 0B00010001, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000},
{0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00011111},
{0B00001000, 0B00000100, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000, 0B00000000},
{0B00000000, 0B00000000, 0B00000000, 0B00001110, 0B00010010, 0B00010010, 0B00010010, 0B00001111},
{0B00000000, 0B00010000, 0B00010000, 0B00010000, 0B00011100, 0B00010010, 0B00010010, 0B00011100},
{0B00000000, 0B00000000, 0B00000000, 0B00001110, 0B00010000, 0B00010000, 0B00010000, 0B00001110},
{0B00000000, 0B00000001, 0B00000001, 0B00000001, 0B00000111, 0B00001001, 0B00001001, 0B00000111},
{0B00000000, 0B00000000, 0B00000000, 0B00011100, 0B00010010, 0B00011110, 0B00010000, 0B00001110},
{0B00000000, 0B00000011, 0B00000100, 0B00000100, 0B00000110, 0B00000100, 0B00000100, 0B00000100},
{0B00000000, 0B00001110, 0B00001010, 0B00001010, 0B00001110, 0B00000010, 0B00000010, 0B00001100},
{0B00000000, 0B00010000, 0B00010000, 0B00010000, 0B00011100, 0B00010010, 0B00010010, 0B00010010},
{0B00000000, 0B00000000, 0B00000100, 0B00000000, 0B00000100, 0B00000100, 0B00000100, 0B00000100},
{0B00000000, 0B00000010, 0B00000000, 0B00000010, 0B00000010, 0B00000010, 0B00000010, 0B00001100},
{0B00000000, 0B00010000, 0B00010000, 0B00010100, 0B00011000, 0B00011000, 0B00010100, 0B00010000},
{0B00000000, 0B00010000, 0B00010000, 0B00010000, 0B00010000, 0B00010000, 0B00010000, 0B00001100},
{0B00000000, 0B00000000, 0B00000000, 0B00001010, 0B00010101, 0B00010001, 0B00010001, 0B00010001},
{0B00000000, 0B00000000, 0B00000000, 0B00010100, 0B00011010, 0B00010010, 0B00010010, 0B00010010},
{0B00000000, 0B00000000, 0B00000000, 0B00001100, 0B00010010, 0B00010010, 0B00010010, 0B00001100},
{0B00000000, 0B00011100, 0B00010010, 0B00010010, 0B00011100, 0B00010000, 0B00010000, 0B00010000},
{0B00000000, 0B00001110, 0B00010010, 0B00010010, 0B00001110, 0B00000010, 0B00000010, 0B00000001},
{0B00000000, 0B00000000, 0B00000000, 0B00001010, 0B00001100, 0B00001000, 0B00001000, 0B00001000},
{0B00000000, 0B00000000, 0B00001110, 0B00010000, 0B00001000, 0B00000100, 0B00000010, 0B00011110},
{0B00000000, 0B00010000, 0B00010000, 0B00011100, 0B00010000, 0B00010000, 0B00010000, 0B00001100},
{0B00000000, 0B00000000, 0B00000000, 0B00010010, 0B00010010, 0B00010010, 0B00010010, 0B00001100},
{0B00000000, 0B00000000, 0B00000000, 0B00010001, 0B00010001, 0B00010001, 0B00001010, 0B00000100},
{0B00000000, 0B00000000, 0B00000000, 0B00010001, 0B00010001, 0B00010001, 0B00010101, 0B00001010},
{0B00000000, 0B00000000, 0B00000000, 0B00010001, 0B00001010, 0B00000100, 0B00001010, 0B00010001},
{0B00000000, 0B00000000, 0B00010001, 0B00001010, 0B00000100, 0B00001000, 0B00001000, 0B00010000},
{0B00000000, 0B00000000, 0B00000000, 0B00011111, 0B00000010, 0B00000100, 0B00001000, 0B00011111},
{0B00000010, 0B00000100, 0B00000100, 0B00000100, 0B00001000, 0B00000100, 0B00000100, 0B00000010},
{0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100, 0B00000100},
{0B00001000, 0B00000100, 0B00000100, 0B00000100, 0B00000010, 0B00000100, 0B00000100, 0B00001000},
{0B00000000, 0B00000000, 0B00000000, 0B00001010, 0B00011110, 0B00010100, 0B00000000, 0B00000000}
};

int GCount;
char mask;
char DRow[8];
//===============================================================================================================================
void INT_Timer1()
{
  char INTData1, INTData2;
  INTData1 = DRow[GCount];
  INTData2 = ~mask; 
    
  digitalWrite(latchPin, LOW);
  shiftOut(dataPin, clockPin, MSBFIRST, INTData1);   
  shiftOut(dataPin, clockPin, LSBFIRST, INTData2);   
  digitalWrite(latchPin, HIGH);
  
  GCount++;
  mask = mask << 1;
  if (GCount > 7)
  {
    GCount = 0;
    mask = 1;
  }  
}
//===============================================================================================================================
void S8x8Setup() {
  pinMode(ledPin, OUTPUT);  //LED
  pinMode(pb1Pin, INPUT);    //PB1
  pinMode(pb2Pin, INPUT);   //PB2
    
  pinMode(latchPin, OUTPUT);
  pinMode(clockPin, OUTPUT);
  pinMode(dataPin, OUTPUT);

  Timer1.initialize(500);
  Timer1.attachInterrupt(INT_Timer1);    

  int i;

  for(int i=0;i<8;i++) {
    DRow[i] = 0;  //CLEAR
  }
  mask = 1;  
  GCount = 0;   
}
//===============================================================================================================================
void DisplayChar(char Data){
    for(int c=0;c<8;c++) {
      DRow[c] = data[Data-32][c];
    }    
}
//===============================================================================================================================



